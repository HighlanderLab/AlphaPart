<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Print method for the output of AlphaPart function. — print.AlphaPart • AlphaPart</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Print method for the output of AlphaPart function. — print.AlphaPart"><meta name="description" content="Partitioning of breeding values if often performed on
quite large datasets, which quickly fills in the whole
screen. Print method therefore prints out paths, number of
individuals and the first and the last few lines for each trait to
quickly see what kind of data is in x."><meta property="og:description" content="Partitioning of breeding values if often performed on
quite large datasets, which quickly fills in the whole
screen. Print method therefore prints out paths, number of
individuals and the first and the last few lines for each trait to
quickly see what kind of data is in x."><meta property="og:image" content="https://alphagenes.github.io/AlphaPart/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AlphaPart</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/alphapart-vignette.html">AlphaPart - R implementation of the method for partitioning genetic trends</a></li>
    <li><a class="dropdown-item" href="../articles/alphapart-variance.html">Partitioning genetic trends in mean and variance</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Print method for the output of AlphaPart function.</h1>

      <div class="d-none name"><code>print.AlphaPart.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Partitioning of breeding values if often performed on
quite large datasets, which quickly fills in the whole
screen. Print method therefore prints out paths, number of
individuals and the first and the last few lines for each trait to
quickly see what kind of data is in <code>x</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'AlphaPart'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>AlphaPart, output object from
<code><a href="AlphaPart.html">AlphaPart</a></code> function.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Integer, number of the first and last rows in <code>x</code> to
print out using <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></code> and <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to <code>print</code> function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="AlphaPart.html">AlphaPart</a></code>, <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></code>,
<code><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Small pedigree with additive genetic (=breeding) values</span></span></span>
<span class="r-in"><span><span class="va">ped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>  id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="fl">1</span>,   <span class="fl">2</span>,   <span class="fl">3</span>,   <span class="fl">4</span>,   <span class="fl">5</span>,   <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   fid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="fl">0</span>,   <span class="fl">0</span>,   <span class="fl">2</span>,   <span class="fl">0</span>,   <span class="fl">4</span>,   <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   mid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="fl">0</span>,   <span class="fl">0</span>,   <span class="fl">1</span>,   <span class="fl">0</span>,   <span class="fl">3</span>,   <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   loc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"A"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   gen<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="fl">1</span>,   <span class="fl">1</span>,   <span class="fl">2</span>,   <span class="fl">2</span>,   <span class="fl">3</span>,   <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  trt1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">120</span>, <span class="fl">115</span>, <span class="fl">130</span>, <span class="fl">125</span>, <span class="fl">125</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  trt2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">110</span>, <span class="fl">105</span>, <span class="fl">100</span>,  <span class="fl">85</span>, <span class="fl">110</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Partition additive genetic values</span></span></span>
<span class="r-in"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="AlphaPart.html">AlphaPart</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ped</span>, colBV<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trt1"</span>, <span class="st">"trt2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - individuals: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - traits: 2 (trt1, trt2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - paths: 2 (A, B)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - unknown (missing) values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt1 trt2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    0 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - individuals: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (A, B)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (trt1, trt2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: trt1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id fid mid loc gen trt1  trt1_pa     trt1_w trt1_A trt1_B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1   0   0   A   1  100 116.6667 -16.666667    100      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2   0   0   B   1  120 116.6667   3.333333      0    120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  3   2   1   A   2  115 110.0000   5.000000     55     60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  4   0   0   B   2  130 116.6667  13.333333      0    130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  5   4   3   A   3  125 122.5000   2.500000     30     95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  6   0   3   A   3  125  57.5000  67.500000     95     30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: trt2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id fid mid loc gen trt2  trt2_pa     trt2_w trt2_A trt2_B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1   0   0   A   1  100 103.3333  -3.333333  100.0    0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2   0   0   B   1  110 103.3333   6.666667    0.0  110.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  3   2   1   A   2  105 105.0000   0.000000   50.0   55.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  4   0   0   B   2  100 103.3333  -3.333333    0.0  100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  5   4   3   A   3   85 102.5000 -17.500000    7.5   77.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  6   0   3   A   3  110  52.5000  57.500000   82.5   27.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Summarize by generation (genetic mean)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tmp</span>, by<span class="op">=</span><span class="st">"gen"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (A, B)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (trt1, trt2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: trt1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N   Sum    A    B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1 2 110.0 50.0 60.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   2 2 122.5 27.5 95.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   3 2 125.0 62.5 62.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: trt2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N   Sum  A    B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1 2 105.0 50 55.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   2 2 102.5 25 77.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   3 2  97.5 45 52.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Summarize by generation (genetic variance)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tmp</span>, by<span class="op">=</span><span class="st">"gen"</span>, FUN <span class="op">=</span> <span class="va">var</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (A, B, Sum.Cov)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (trt1, trt2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: trt1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N   Sum      A      B Sum.Cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1 2 200.0 5000.0 7200.0  -12000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   2 2 112.5 1512.5 2450.0   -3850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   3 2   0.0 2112.5 2112.5   -4225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: trt2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N   Sum      A      B Sum.Cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1 2  50.0 5000.0 6050.0  -11000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   2 2  12.5 1250.0 1012.5   -2250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   3 2 312.5 2812.5 1250.0   -3750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## There are also two demos</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/demo.html" class="external-link">demo</a></span><span class="op">(</span>topic<span class="op">=</span><span class="st">"AlphaPart_deterministic"</span>, package<span class="op">=</span><span class="st">"AlphaPart"</span>,</span></span>
<span class="r-in"><span>       ask<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	demo(AlphaPart_deterministic)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	---- ~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### partAGV_deterministic.R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### $Id$</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### DESCRIPTION OF A DEMONSTRATION</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## A demonstration with a simple example to see in action the partitioning of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## additive genetic values by paths (Garcia-Cortes et al., 2008; Animal)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## DETERMINISTIC SIMULATION (sort of)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## We have two locations (1 and 2). The first location has individualss with higher</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## additive genetic value. Males from the first location are imported males to the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## second location from generation 2/3. This clearly leads to genetic gain in the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## second location. However, the second location can also perform their own selection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## so the question is how much genetic gain is due to the import of genes from the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## first location and due to their own selection.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Above scenario will be tested with a simple example of a pedigree bellow. Two</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## scenarios will be evaluated: without or with own selection in the second location.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Selection will always be present in the first location.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Additive genetic values are provided, i.e., no inference is being done!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## The idea of this example is not to do extensive simulations, but just to have</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## a simple example to see how the partitioning of additive genetic values works.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### SETUP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; options(width=200)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### EXAMPLE PEDIGREE &amp; SETUP OF MENDELIAN SAMPLING - "DETERMINISTIC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   id0 &lt;- c("01", "02", "03", "04")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  fid0 &lt;- mid0 &lt;- rep(NA, times=length(id0))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    h0 &lt;- rep(c(1, 2), each=2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    g0 &lt;- rep(0, times=length(id0))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w10 &lt;- c( 2, 2, 0, 0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w20 &lt;- c( 2, 2, 0, 0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   id1 &lt;- c("11", "12", "13", "14")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  fid1 &lt;- c("01", "01", "03", "03")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  mid1 &lt;- c("02", "02", "04", "04")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    h1 &lt;- h0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    g1 &lt;- rep(1, times=length(id1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w11 &lt;- c( 0.6,  0.2, -0.6,  0.2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w21 &lt;- c( 0.6,  0.2,  0.6,  0.2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   id2 &lt;- c("21", "22", "23", "24")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  fid2 &lt;- c("12", "12", "12", "12")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  mid2 &lt;- c("11", "11", "13", "14")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    h2 &lt;- h0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    g2 &lt;- rep(2, times=length(id2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w12 &lt;- c( 0.6,  0.3, -0.2,  0.2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w22 &lt;- c( 0.6,  0.3,  0.2,  0.2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   id3 &lt;- c("31", "32", "33", "34")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  fid3 &lt;- c("22", "22", "22", "22")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  mid3 &lt;- c("21", "21", "23", "24")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    h3 &lt;- h0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    g3 &lt;- rep(3, times=length(id3))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w13 &lt;- c( 0.7,  0.1, -0.3,  0.3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w23 &lt;- c( 0.7,  0.1,  0.3,  0.3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   id4 &lt;- c("41", "42", "43", "44")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  fid4 &lt;- c("32", "32", "32", "32")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  mid4 &lt;- c("31", "31", "33", "34")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    h4 &lt;- h0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    g4 &lt;- rep(4, times=length(id4))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w14 &lt;- c( 0.8,  0.8, -0.1,  0.3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w24 &lt;- c( 0.8,  0.8,  0.1,  0.3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   id5 &lt;- c("51", "52", "53", "54")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  fid5 &lt;- c("42", "42", "42", "42")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  mid5 &lt;- c("41", "41", "43", "44")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    h5 &lt;- h0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;    g5 &lt;- rep(5, times=length(id4))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w15 &lt;- c( 0.8,  1.0, -0.2,  0.3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   w25 &lt;- c( 0.8,  1.0,  0.2,  0.3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped &lt;- data.frame( id=c( id0,  id1,  id2,  id3,  id4,  id5),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                   fid=c(fid0, fid1, fid2, fid3, fid4, fid5),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                   mid=c(mid0, mid1, mid2, mid3, mid4, mid5),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                   loc=c(  h0,   h1,   h2,   h3,   h4,  h5),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                   gen=c(  g0,   g1,   g2,   g3,   g4,  g5),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                    w1=c( w10,  w11,  w12,  w13,  w14,  w15),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                    w2=c( w20,  w21,  w22,  w23,  w24,  w25))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped$sex &lt;- 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped[ped$id %in% ped$fid, "sex"] &lt;- 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped$loc.gen &lt;- with(ped, paste(loc, gen, sep="-"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### SIMULATE ADDITIVE GENETIC VALUES - SUM PARENT AVERAGE AND MENDELIAN SAMPLING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Additive genetic mean in founders by location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mu1 &lt;-  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mu2 &lt;-  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Additive genetic variance in population</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; sigma2 &lt;- 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; sigma  &lt;- sqrt(sigma2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Threshold value for Mendelian sampling for selection - only values above this</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##  will be accepted in simulation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; t &lt;- 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped$agv1 &lt;- ped$pa1 &lt;- NA ## Scenario (trait) 1: No selection in the second location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped$agv2 &lt;- ped$pa2 &lt;- NA ## Scenario (trait) 2:    Selection in the second location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 0  - founders (no parent average here - so setting it to zero)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped[ped$gen == 0, c("pa1",  "pa2")] &lt;- 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped[ped$gen == 0, c("agv1", "agv2")] &lt;- ped[ped$gen == 0, c("w1", "w2")]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 1+ - non-founders (parent average + Mendelian sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; for(i in (length(g0)+1):nrow(ped)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   ped[i, "pa1"] &lt;- 0.5 * (ped[ped$id %in% ped[i, "fid"], "agv1"] +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                           ped[ped$id %in% ped[i, "mid"], "agv1"])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   ped[i, "pa2"] &lt;- 0.5 * (ped[ped$id %in% ped[i, "fid"], "agv2"] +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                           ped[ped$id %in% ped[i, "mid"], "agv2"])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   ped[i, c("agv1", "agv2")] &lt;- ped[i, c("pa1", "pa2")] + ped[i, c("w1", "w2")]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### PLOT INDIVIDUAL ADDITIVE GENETIC VALUES</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; par(mfrow=c(2, 1), bty="l", pty="m", mar=c(2, 2, 1, 1) + .1, mgp=c(0.7, 0.2, 0))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; tmp &lt;- ped$gen + c(-1.5, -0.5, 0.5, 1.5) * 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; with(ped, plot(agv1 ~ tmp, pch=c(19, 21)[ped$loc], ylab="Additive genetic value",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                xlab="Generation", main="Selection in location 1", axes=FALSE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                ylim=range(c(agv1, agv2))))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; axis(1, labels=FALSE, tick=FALSE); axis(2, labels=FALSE, tick=FALSE); box()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; legend(x="topleft", legend=c(1, 2), title="Location", pch=c(19, 21), bty="n")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; with(ped, plot(agv2 ~ tmp, pch=c(19, 21)[ped$loc], ylab="Additive genetic value",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                xlab="Generation", main="Selection in locations 1 and 2", axes=FALSE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                ylim=range(c(agv1, agv2))))</span>
<span class="r-plt img"><img src="print.AlphaPart-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; axis(1, labels=FALSE, tick=FALSE); axis(2, labels=FALSE, tick=FALSE); box()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; legend(x="topleft", legend=c(1, 2), title="Location", pch=c(19, 21), bty="n")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### PARTITION ADDITIVE GENETIC VALUES BY ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Compute partitions by location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (res &lt;- AlphaPart(x=ped, colPath="loc", colBV=c("agv1", "agv2")))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - individuals: 24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - unknown (missing) values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agv1 agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - individuals: 24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id  fid  mid loc gen  w1  w2 sex loc.gen pa1 pa2 agv1 agv1_pa agv1_w agv1_1 agv1_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 01 &lt;NA&gt; &lt;NA&gt;   1   0 2.0 2.0   1     1-0   0   0  2.0       0    2.0    2.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 02 &lt;NA&gt; &lt;NA&gt;   1   0 2.0 2.0   2     1-0   0   0  2.0       0    2.0    2.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 03 &lt;NA&gt; &lt;NA&gt;   2   0 0.0 0.0   1     2-0   0   0  0.0       0    0.0    0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 04 &lt;NA&gt; &lt;NA&gt;   2   0 0.0 0.0   2     2-0   0   0  0.0       0    0.0    0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 11   01   02   1   1 0.6 0.6   2     1-1   2   2  2.6       2    0.6    2.6      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 12   01   02   1   1 0.2 0.2   1     1-1   2   2  2.2       2    0.2    2.2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id fid mid loc gen   w1  w2 sex loc.gen  pa1   pa2 agv1 agv1_pa agv1_w agv1_1  agv1_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 43  32  33   2   4 -0.1 0.1   2     2-4 2.15 2.700 2.05    2.15   -0.1 2.4250 -0.3750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 44  32  34   2   4  0.3 0.3   2     2-4 2.65 2.650 2.95    2.65    0.3 2.4250  0.5250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 51  42  41   1   5  0.8 0.8   2     1-5 4.05 4.050 4.85    4.05    0.8 4.8500  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 52  42  41   1   5  1.0 1.0   2     1-5 4.05 4.050 5.05    4.05    1.0 5.0500  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 53  42  43   2   5 -0.2 0.2   2     2-5 3.05 3.425 2.85    3.05   -0.2 3.2375 -0.3875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 54  42  44   2   5  0.3 0.3   2     2-5 3.50 3.500 3.80    3.50    0.3 3.2375  0.5625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id  fid  mid loc gen  w1  w2 sex loc.gen pa1 pa2 agv2 agv2_pa agv2_w agv2_1 agv2_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 01 &lt;NA&gt; &lt;NA&gt;   1   0 2.0 2.0   1     1-0   0   0  2.0       0    2.0    2.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 02 &lt;NA&gt; &lt;NA&gt;   1   0 2.0 2.0   2     1-0   0   0  2.0       0    2.0    2.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 03 &lt;NA&gt; &lt;NA&gt;   2   0 0.0 0.0   1     2-0   0   0  0.0       0    0.0    0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 04 &lt;NA&gt; &lt;NA&gt;   2   0 0.0 0.0   2     2-0   0   0  0.0       0    0.0    0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 11   01   02   1   1 0.6 0.6   2     1-1   2   2  2.6       2    0.6    2.6      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 12   01   02   1   1 0.2 0.2   1     1-1   2   2  2.2       2    0.2    2.2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id fid mid loc gen   w1  w2 sex loc.gen  pa1   pa2  agv2 agv2_pa agv2_w agv2_1 agv2_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 43  32  33   2   4 -0.1 0.1   2     2-4 2.15 2.700 2.800   2.700    0.1 2.4250 0.3750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 44  32  34   2   4  0.3 0.3   2     2-4 2.65 2.650 2.950   2.650    0.3 2.4250 0.5250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 51  42  41   1   5  0.8 0.8   2     1-5 4.05 4.050 4.850   4.050    0.8 4.8500 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 52  42  41   1   5  1.0 1.0   2     1-5 4.05 4.050 5.050   4.050    1.0 5.0500 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 53  42  43   2   5 -0.2 0.2   2     2-5 3.05 3.425 3.625   3.425    0.2 3.2375 0.3875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 54  42  44   2   5  0.3 0.3   2     2-5 3.50 3.500 3.800   3.500    0.3 3.2375 0.5625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize whole population</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N NA     Sum        1         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 24 2.33125 2.346875 -0.015625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N NA      Sum        1         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 24 2.532292 2.346875 0.1854167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot by generation (=trend)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="gen"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N    Sum       1        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0 4 1.0000 1.00000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 4 1.1000 1.20000 -0.10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2 4 1.9250 1.97500 -0.05000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   3 4 2.5500 2.57500 -0.02500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   4 4 3.2750 3.23750  0.03750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   5 4 4.1375 4.09375  0.04375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N     Sum       1      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0 4 1.00000 1.00000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 4 1.40000 1.20000 0.2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2 4 2.17500 1.97500 0.2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   3 4 2.82500 2.57500 0.2500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   4 4 3.46250 3.23750 0.2250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   5 4 4.33125 4.09375 0.2375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    loc.gen N    Sum      1       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1-0 2  2.000 2.0000  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1-1 2  2.400 2.4000  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1-2 2  2.850 2.8500  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1-3 2  3.250 3.2500  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1-4 2  4.050 4.0500  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      1-5 2  4.950 4.9500  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      2-0 2  0.000 0.0000  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2-1 2 -0.200 0.0000 -0.2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      2-2 2  1.000 1.1000 -0.1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     2-3 2  1.850 1.9000 -0.0500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     2-4 2  2.500 2.4250  0.0750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     2-5 2  3.325 3.2375  0.0875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    loc.gen N    Sum      1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1-0 2 2.0000 2.0000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1-1 2 2.4000 2.4000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1-2 2 2.8500 2.8500 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1-3 2 3.2500 3.2500 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1-4 2 4.0500 4.0500 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      1-5 2 4.9500 4.9500 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      2-0 2 0.0000 0.0000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2-1 2 0.4000 0.0000 0.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      2-2 2 1.5000 1.1000 0.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     2-3 2 2.4000 1.9000 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     2-4 2 2.8750 2.4250 0.450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     2-5 2 3.7125 3.2375 0.475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-4.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends but only for location 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen", subset=res[[1]]$loc == 1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N  Sum    1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1-0 2 2.00 2.00 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1-1 2 2.40 2.40 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1-2 2 2.85 2.85 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1-3 2 3.25 3.25 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1-4 2 4.05 4.05 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1-5 2 4.95 4.95 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N  Sum    1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1-0 2 2.00 2.00 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1-1 2 2.40 2.40 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1-2 2 2.85 2.85 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1-3 2 3.25 3.25 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1-4 2 4.05 4.05 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1-5 2 4.95 4.95 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-6.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-7.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends but only for location 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen", subset=res[[1]]$loc == 2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N    Sum      1       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     2-0 2  0.000 0.0000  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2-1 2 -0.200 0.0000 -0.2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2-2 2  1.000 1.1000 -0.1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2-3 2  1.850 1.9000 -0.0500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2-4 2  2.500 2.4250  0.0750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2-5 2  3.325 3.2375  0.0875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N    Sum      1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     2-0 2 0.0000 0.0000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2-1 2 0.4000 0.0000 0.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2-2 2 1.5000 1.1000 0.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2-3 2 2.4000 1.9000 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2-4 2 2.8750 2.4250 0.450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2-5 2 3.7125 3.2375 0.475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-8.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-9.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Compute partitions by location and sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped$loc.sex &lt;- with(ped, paste(loc, sex, sep="-"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (res &lt;- AlphaPart(x=ped, colPath="loc.sex", colBV=c("agv1", "agv2")))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - individuals: 24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - unknown (missing) values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agv1 agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - individuals: 24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id  fid  mid loc gen  w1  w2 sex loc.gen pa1 pa2 loc.sex agv1 agv1_pa agv1_w agv1_1-1 agv1_1-2 agv1_2-1 agv1_2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 01 &lt;NA&gt; &lt;NA&gt;   1   0 2.0 2.0   1     1-0   0   0     1-1  2.0       0    2.0      2.0      0.0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 02 &lt;NA&gt; &lt;NA&gt;   1   0 2.0 2.0   2     1-0   0   0     1-2  2.0       0    2.0      0.0      2.0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 03 &lt;NA&gt; &lt;NA&gt;   2   0 0.0 0.0   1     2-0   0   0     2-1  0.0       0    0.0      0.0      0.0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 04 &lt;NA&gt; &lt;NA&gt;   2   0 0.0 0.0   2     2-0   0   0     2-2  0.0       0    0.0      0.0      0.0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 11   01   02   1   1 0.6 0.6   2     1-1   2   2     1-2  2.6       2    0.6      1.0      1.6        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 12   01   02   1   1 0.2 0.2   1     1-1   2   2     1-1  2.2       2    0.2      1.2      1.0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id fid mid loc gen   w1  w2 sex loc.gen  pa1   pa2 loc.sex agv1 agv1_pa agv1_w agv1_1-1 agv1_1-2 agv1_2-1 agv1_2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 43  32  33   2   4 -0.1 0.1   2     2-4 2.15 2.700     2-2 2.05    2.15   -0.1   1.1750     1.25        0  -0.3750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 44  32  34   2   4  0.3 0.3   2     2-4 2.65 2.650     2-2 2.95    2.65    0.3   1.1750     1.25        0   0.5250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 51  42  41   1   5  0.8 0.8   2     1-5 4.05 4.050     1-2 4.85    4.05    0.8   1.7000     3.15        0   0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 52  42  41   1   5  1.0 1.0   2     1-5 4.05 4.050     1-2 5.05    4.05    1.0   1.7000     3.35        0   0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 53  42  43   2   5 -0.2 0.2   2     2-5 3.05 3.425     2-2 2.85    3.05   -0.2   1.6375     1.60        0  -0.3875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 54  42  44   2   5  0.3 0.3   2     2-5 3.50 3.500     2-2 3.80    3.50    0.3   1.6375     1.60        0   0.5625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id  fid  mid loc gen  w1  w2 sex loc.gen pa1 pa2 loc.sex agv2 agv2_pa agv2_w agv2_1-1 agv2_1-2 agv2_2-1 agv2_2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 01 &lt;NA&gt; &lt;NA&gt;   1   0 2.0 2.0   1     1-0   0   0     1-1  2.0       0    2.0      2.0      0.0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 02 &lt;NA&gt; &lt;NA&gt;   1   0 2.0 2.0   2     1-0   0   0     1-2  2.0       0    2.0      0.0      2.0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 03 &lt;NA&gt; &lt;NA&gt;   2   0 0.0 0.0   1     2-0   0   0     2-1  0.0       0    0.0      0.0      0.0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 04 &lt;NA&gt; &lt;NA&gt;   2   0 0.0 0.0   2     2-0   0   0     2-2  0.0       0    0.0      0.0      0.0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 11   01   02   1   1 0.6 0.6   2     1-1   2   2     1-2  2.6       2    0.6      1.0      1.6        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 12   01   02   1   1 0.2 0.2   1     1-1   2   2     1-1  2.2       2    0.2      1.2      1.0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id fid mid loc gen   w1  w2 sex loc.gen  pa1   pa2 loc.sex  agv2 agv2_pa agv2_w agv2_1-1 agv2_1-2 agv2_2-1 agv2_2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 43  32  33   2   4 -0.1 0.1   2     2-4 2.15 2.700     2-2 2.800   2.700    0.1   1.1750     1.25        0   0.3750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 44  32  34   2   4  0.3 0.3   2     2-4 2.65 2.650     2-2 2.950   2.650    0.3   1.1750     1.25        0   0.5250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 51  42  41   1   5  0.8 0.8   2     1-5 4.05 4.050     1-2 4.850   4.050    0.8   1.7000     3.15        0   0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 52  42  41   1   5  1.0 1.0   2     1-5 4.05 4.050     1-2 5.050   4.050    1.0   1.7000     3.35        0   0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 53  42  43   2   5 -0.2 0.2   2     2-5 3.05 3.425     2-2 3.625   3.425    0.2   1.6375     1.60        0   0.3875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 54  42  44   2   5  0.3 0.3   2     2-5 3.50 3.500     2-2 3.800   3.500    0.3   1.6375     1.60        0   0.5625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot by generation (=trend)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="gen"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N    Sum     1-1   1-2 2-1      2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0 4 1.0000 0.50000 0.500   0  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 4 1.1000 0.55000 0.650   0 -0.10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2 4 1.9250 0.92500 1.050   0 -0.05000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   3 4 2.5500 1.15000 1.425   0 -0.02500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   4 4 3.2750 1.43750 1.800   0  0.03750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   5 4 4.1375 1.66875 2.425   0  0.04375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N     Sum     1-1   1-2 2-1    2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0 4 1.00000 0.50000 0.500   0 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 4 1.40000 0.55000 0.650   0 0.2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2 4 2.17500 0.92500 1.050   0 0.2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   3 4 2.82500 1.15000 1.425   0 0.2500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   4 4 3.46250 1.43750 1.800   0 0.2250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   5 4 4.33125 1.66875 2.425   0 0.2375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-10.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-11.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret, lineTypeList=list("-1"=1, "-2"=2, def=3))</span>
<span class="r-plt img"><img src="print.AlphaPart-12.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-13.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    loc.gen N    Sum    1-1  1-2 2-1     2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1-0 2  2.000 1.0000 1.00   0  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1-1 2  2.400 1.1000 1.30   0  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1-2 2  2.850 1.2500 1.60   0  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1-3 2  3.250 1.3000 1.95   0  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1-4 2  4.050 1.7000 2.35   0  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      1-5 2  4.950 1.7000 3.25   0  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      2-0 2  0.000 0.0000 0.00   0  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2-1 2 -0.200 0.0000 0.00   0 -0.2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      2-2 2  1.000 0.6000 0.50   0 -0.1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     2-3 2  1.850 1.0000 0.90   0 -0.0500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     2-4 2  2.500 1.1750 1.25   0  0.0750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     2-5 2  3.325 1.6375 1.60   0  0.0875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    loc.gen N    Sum    1-1  1-2 2-1   2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1-0 2 2.0000 1.0000 1.00   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1-1 2 2.4000 1.1000 1.30   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1-2 2 2.8500 1.2500 1.60   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1-3 2 3.2500 1.3000 1.95   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1-4 2 4.0500 1.7000 2.35   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      1-5 2 4.9500 1.7000 3.25   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      2-0 2 0.0000 0.0000 0.00   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2-1 2 0.4000 0.0000 0.00   0 0.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      2-2 2 1.5000 0.6000 0.50   0 0.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     2-3 2 2.4000 1.0000 0.90   0 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     2-4 2 2.8750 1.1750 1.25   0 0.450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     2-5 2 3.7125 1.6375 1.60   0 0.475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret, lineTypeList=list("-1"=1, "-2"=2, def=3))</span>
<span class="r-plt img"><img src="print.AlphaPart-14.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-15.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends but only for location 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen", subset=res[[1]]$loc == 1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N  Sum  1-1  1-2 2-1 2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1-0 2 2.00 1.00 1.00   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1-1 2 2.40 1.10 1.30   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1-2 2 2.85 1.25 1.60   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1-3 2 3.25 1.30 1.95   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1-4 2 4.05 1.70 2.35   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1-5 2 4.95 1.70 3.25   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N  Sum  1-1  1-2 2-1 2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1-0 2 2.00 1.00 1.00   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1-1 2 2.40 1.10 1.30   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1-2 2 2.85 1.25 1.60   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1-3 2 3.25 1.30 1.95   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1-4 2 4.05 1.70 2.35   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1-5 2 4.95 1.70 3.25   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-16.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-17.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends but only for location 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen", subset=res[[1]]$loc == 2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N    Sum    1-1  1-2 2-1     2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     2-0 2  0.000 0.0000 0.00   0  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2-1 2 -0.200 0.0000 0.00   0 -0.2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2-2 2  1.000 0.6000 0.50   0 -0.1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2-3 2  1.850 1.0000 0.90   0 -0.0500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2-4 2  2.500 1.1750 1.25   0  0.0750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2-5 2  3.325 1.6375 1.60   0  0.0875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N    Sum    1-1  1-2 2-1   2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     2-0 2 0.0000 0.0000 0.00   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2-1 2 0.4000 0.0000 0.00   0 0.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2-2 2 1.5000 0.6000 0.50   0 0.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2-3 2 2.4000 1.0000 0.90   0 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2-4 2 2.8750 1.1750 1.25   0 0.450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2-5 2 3.7125 1.6375 1.60   0 0.475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-18.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-19.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### AlphaPart_deterministic.R ends here</span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/demo.html" class="external-link">demo</a></span><span class="op">(</span>topic<span class="op">=</span><span class="st">"AlphaPart_stochastic"</span>,     package<span class="op">=</span><span class="st">"AlphaPart"</span>,</span></span>
<span class="r-in"><span>       ask<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	demo(AlphaPart_stochastic)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	---- ~~~~~~~~~~~~~~~~~~~~</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### demo_stohastic.R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### $Id$</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### DESCRIPTION OF A DEMONSTRATION</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## A demonstration with a simple example to see in action the partitioning of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## additive genetic values by paths (Garcia-Cortes et al., 2008; Animal)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## STOHASTIC SIMULATION (sort of)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## We have two locations (1 and 2). The first location has individualss with higher</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## additive genetic value. Males from the first location are imported males to the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## second location from generation 2/3. This clearly leads to genetic gain in the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## second location. However, the second location can also perform their own selection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## so the question is how much genetic gain is due to the import of genes from the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## first location and due to their own selection.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Above scenario will be tested with a simple example of a pedigree bellow. Two</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## scenarios will be evaluated: without or with own selection in the second location.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Selection will always be present in the first location.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Additive genetic values are provided, i.e., no inference is being done!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## The idea of this example is not to do extensive simulations, but just to have</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## a simple example to see how the partitioning of additive genetic values works.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### SETUP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; options(width=200)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## install.packages(pkg=c("truncnorm"), dep=TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; library(package="truncnorm")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### EXAMPLE PEDIGREE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  id0 &lt;- c("01", "02", "03", "04", "05", "06", "07", "08")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; fid0 &lt;- mid0 &lt;- rep(NA, times=length(id0))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   h0 &lt;- rep(c(1, 2), each=4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   g0 &lt;- rep(0, times=length(id0))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  id1 &lt;- c("11", "12", "13", "14", "15", "16", "17", "18")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; fid1 &lt;- c("02", "02", "02", "02", "06", "06", "06", "06")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mid1 &lt;- c("01", "01", "03", "04", "05", "05", "07", "08")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   h1 &lt;- h0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   g1 &lt;- rep(1, times=length(id1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  id2 &lt;- c("21", "22", "23", "24", "25", "26", "27", "28")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; fid2 &lt;- c("13", "13", "13", "13", "13", "13", "13", "13")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mid2 &lt;- c("11", "12", "14", "14", "15", "16", "17", "18")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   h2 &lt;- h0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   g2 &lt;- rep(2, times=length(id2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  id3 &lt;- c("31", "32", "33", "34", "35", "36", "37", "38")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; fid3 &lt;- c("24", "24", "24", "24", "24", "24", "24", "24")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mid3 &lt;- c("21", "21", "22", "23", "25", "26", "27", "28")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   h3 &lt;- h0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   g3 &lt;- rep(3, times=length(id3))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  id4 &lt;- c("41", "42", "43", "44", "45", "46", "47", "48")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; fid4 &lt;- c("34", "34", "34", "34", "34", "34", "34", "34")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mid4 &lt;- c("31", "32", "32", "33", "35", "36", "37", "38")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   h4 &lt;- h0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   g4 &lt;- rep(4, times=length(id4))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;  id5 &lt;- c("51", "52", "53", "54", "55", "56", "57", "58")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; fid5 &lt;- c("44", "44", "44", "44", "44", "44", "44", "44")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mid5 &lt;- c("41", "42", "43", "43", "45", "46", "47", "48")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   h5 &lt;- h0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;   g5 &lt;- rep(5, times=length(id4))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped &lt;- data.frame( id=c( id0,  id1,  id2,  id3,  id4,  id5),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                   fid=c(fid0, fid1, fid2, fid3, fid4, fid5),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                   mid=c(mid0, mid1, mid2, mid3, mid4, mid5),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                   loc=c(  h0,   h1,   h2,   h3,   h4,   h5),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                   gen=c(  g0,   g1,   g2,   g3,   g4,   g5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped$sex &lt;- 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped[ped$id %in% ped$fid, "sex"] &lt;- 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped$loc.gen &lt;- with(ped, paste(loc, gen, sep="-"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### SIMULATE ADDITIVE GENETIC VALUES - STOHASTIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## --- Parameters of simulation ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Additive genetic mean in founders by location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mu1 &lt;- 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; mu2 &lt;- 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Additive genetic variance in population</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; sigma2 &lt;- 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; sigma  &lt;- sqrt(sigma2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Threshold value for Mendelian sampling for selection - only values above this</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ##  will be accepted in simulation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; t &lt;- 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Set seed for simulation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; set.seed(seed=19791123)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## --- Start of simulation ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped$agv1 &lt;- NA ## Scenario (trait) 1: No selection in the second location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped$agv2 &lt;- NA ## Scenario (trait) 2:    Selection in the second location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 0  - founders (for simplicity set their values to the mean of location)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped[ped$gen == 0 &amp; ped$loc == 1, c("agv1", "agv2")] &lt;- mu1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped[ped$gen == 0 &amp; ped$loc == 2, c("agv1", "agv2")] &lt;- mu2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Generation 1+ - non-founders</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; for(i in (length(g0)+1):nrow(ped)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   ## Scenario (trait) 1: selection only in the first location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   if(ped[i, "loc"] == 1) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +     w &lt;- rtruncnorm(n=1, mean=0, sd=sqrt(sigma2/2), a=t)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   } else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +     w &lt;-      rnorm(n=1, mean=0, sd=sqrt(sigma2/2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   ped[i, "agv1"] &lt;- round(0.5 * ped[ped$id %in% ped[i, "fid"], "agv1"] +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                           0.5 * ped[ped$id %in% ped[i, "mid"], "agv1"] +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                           w, digits=1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   ## Scenario (trait) 2: selection in both locations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   if(ped[i, "loc"] == 2) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +     w &lt;- rtruncnorm(n=1, mean=0, sd=sqrt(sigma2/2), a=t)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   } ## for location 1 take the same values as above</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +   ped[i, "agv2"] &lt;- round(0.5 * ped[ped$id %in% ped[i, "fid"], "agv2"] +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                           0.5 * ped[ped$id %in% ped[i, "mid"], "agv2"] +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                           w, digits=1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### PLOT INDIVIDUAL ADDITIVE GENETIC VALUES</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; par(mfrow=c(2, 1), bty="l", pty="m", mar=c(2, 2, 1, 1) + .1, mgp=c(0.7, 0.2, 0))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; tmp &lt;- ped$gen + c(-1.5, -0.5, 0.5, 1.5) * 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; with(ped, plot(agv1 ~ tmp, pch=c(19, 21)[ped$loc], ylab="Additive genetic value",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                xlab="Generation", main="Selection in location 1", axes=FALSE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                ylim=range(c(agv1, agv2))))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; axis(1, labels=FALSE, tick=FALSE); axis(2, labels=FALSE, tick=FALSE); box()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; legend(x="topleft", legend=c(1, 2), title="Location", pch=c(19, 21), bty="n")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; with(ped, plot(agv2 ~ tmp, pch=c(19, 21)[ped$loc], ylab="Additive genetic value",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                xlab="Generation", main="Selection in locations 1 and 2", axes=FALSE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +                ylim=range(c(agv1, agv2))))</span>
<span class="r-plt img"><img src="print.AlphaPart-20.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; axis(1, labels=FALSE, tick=FALSE); axis(2, labels=FALSE, tick=FALSE); box()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; legend(x="topleft", legend=c(1, 2), title="Location", pch=c(19, 21), bty="n")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### PARTITION ADDITIVE GENETIC VALUES BY ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Compute partitions by location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (res &lt;- AlphaPart(x=ped, colPath="loc", colBV=c("agv1", "agv2")))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - individuals: 48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - unknown (missing) values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agv1 agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - individuals: 48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id  fid  mid loc gen sex loc.gen agv1 agv1_pa agv1_w agv1_1 agv1_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 01 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0    2       1      1      2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 02 &lt;NA&gt; &lt;NA&gt;   1   0   1     1-0    2       1      1      2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 03 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0    2       1      1      2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 04 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0    2       1      1      2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 05 &lt;NA&gt; &lt;NA&gt;   2   0   2     2-0    0       1     -1      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 06 &lt;NA&gt; &lt;NA&gt;   2   0   1     2-0    0       1     -1      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id fid mid loc gen sex loc.gen agv1 agv1_pa agv1_w agv1_1 agv1_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 53  44  43   1   5   2     1-5  5.3    4.15   1.15   5.30   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 54  44  43   1   5   2     1-5  4.2    4.15   0.05   4.20   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 55  44  45   2   5   2     2-5  4.1    3.15   0.95   3.35   0.75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 56  44  46   2   5   2     2-5  2.7    3.20  -0.50   3.35  -0.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 57  44  47   2   5   2     2-5  3.5    3.20   0.30   3.35   0.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 58  44  48   2   5   2     2-5  3.8    4.35  -0.55   3.35   0.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id  fid  mid loc gen sex loc.gen agv2 agv2_pa agv2_w agv2_1 agv2_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 01 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0    2       1      1      2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 02 &lt;NA&gt; &lt;NA&gt;   1   0   1     1-0    2       1      1      2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 03 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0    2       1      1      2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 04 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0    2       1      1      2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 05 &lt;NA&gt; &lt;NA&gt;   2   0   2     2-0    0       1     -1      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 06 &lt;NA&gt; &lt;NA&gt;   2   0   1     2-0    0       1     -1      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id fid mid loc gen sex loc.gen agv2 agv2_pa agv2_w agv2_1 agv2_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 53  44  43   1   5   2     1-5  5.3    4.15   1.15   5.30   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 54  44  43   1   5   2     1-5  4.2    4.15   0.05   4.20   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 55  44  45   2   5   2     2-5  3.7    3.65   0.05   3.35   0.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 56  44  46   2   5   2     2-5  5.2    4.00   1.20   3.35   1.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 57  44  47   2   5   2     2-5  4.1    3.90   0.20   3.35   0.75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 58  44  48   2   5   2     2-5  4.3    3.60   0.70   3.35   0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize whole population</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N NA      Sum        1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 48 2.466667 2.391667 0.075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N NA      Sum        1         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 48 2.820833 2.391667 0.4291667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot by generation (=trend)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="gen"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N    Sum      1       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0 8 1.0000 1.0000  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 8 1.4875 1.2125  0.2750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2 8 1.8875 2.0500 -0.1625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   3 8 2.7500 2.6250  0.1250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   4 8 3.6125 3.4875  0.1250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   5 8 4.0625 3.9750  0.0875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N    Sum      1      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0 8 1.0000 1.0000 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 8 1.5500 1.2125 0.3375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2 8 2.7125 2.0500 0.6625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   3 8 3.2750 2.6250 0.6500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   4 8 3.9250 3.4875 0.4375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   5 8 4.4625 3.9750 0.4875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-21.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-22.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    loc.gen N   Sum     1      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1-0 4 2.000 2.000  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1-1 4 2.425 2.425  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1-2 4 2.700 2.700  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1-3 4 3.250 3.250  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1-4 4 4.275 4.275  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      1-5 4 4.600 4.600  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      2-0 4 0.000 0.000  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2-1 4 0.550 0.000  0.550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      2-2 4 1.075 1.400 -0.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     2-3 4 2.250 2.000  0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     2-4 4 2.950 2.700  0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     2-5 4 3.525 3.350  0.175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    loc.gen N   Sum     1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1-0 4 2.000 2.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1-1 4 2.425 2.425 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1-2 4 2.700 2.700 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1-3 4 3.250 3.250 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1-4 4 4.275 4.275 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      1-5 4 4.600 4.600 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      2-0 4 0.000 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2-1 4 0.675 0.000 0.675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      2-2 4 2.725 1.400 1.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     2-3 4 3.300 2.000 1.300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     2-4 4 3.575 2.700 0.875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     2-5 4 4.325 3.350 0.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-23.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-24.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends but only for location 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen", subset=res[[1]]$loc == 1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N   Sum     1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1-0 4 2.000 2.000 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1-1 4 2.425 2.425 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1-2 4 2.700 2.700 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1-3 4 3.250 3.250 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1-4 4 4.275 4.275 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1-5 4 4.600 4.600 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N   Sum     1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1-0 4 2.000 2.000 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1-1 4 2.425 2.425 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1-2 4 2.700 2.700 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1-3 4 3.250 3.250 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1-4 4 4.275 4.275 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1-5 4 4.600 4.600 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-25.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-26.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends but only for location 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen", subset=res[[1]]$loc == 2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 2 (1, 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N   Sum    1      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     2-0 4 0.000 0.00  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2-1 4 0.550 0.00  0.550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2-2 4 1.075 1.40 -0.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2-3 4 2.250 2.00  0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2-4 4 2.950 2.70  0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2-5 4 3.525 3.35  0.175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N   Sum    1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     2-0 4 0.000 0.00 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2-1 4 0.675 0.00 0.675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2-2 4 2.725 1.40 1.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2-3 4 3.300 2.00 1.300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2-4 4 3.575 2.70 0.875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2-5 4 4.325 3.35 0.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-27.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-28.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Compute partitions by location and sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ped$loc.sex &lt;- with(ped, paste(loc, sex, sep="-"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (res &lt;- AlphaPart(x=ped, colPath="loc.sex", colBV=c("agv1", "agv2")))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - individuals: 48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - unknown (missing) values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agv1 agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - individuals: 48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id  fid  mid loc gen sex loc.gen loc.sex agv1 agv1_pa agv1_w agv1_1-1 agv1_1-2 agv1_2-1 agv1_2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 01 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0     1-2    2       1      1        0        2        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 02 &lt;NA&gt; &lt;NA&gt;   1   0   1     1-0     1-1    2       1      1        2        0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 03 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0     1-2    2       1      1        0        2        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 04 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0     1-2    2       1      1        0        2        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 05 &lt;NA&gt; &lt;NA&gt;   2   0   2     2-0     2-2    0       1     -1        0        0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 06 &lt;NA&gt; &lt;NA&gt;   2   0   1     2-0     2-1    0       1     -1        0        0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id fid mid loc gen sex loc.gen loc.sex agv1 agv1_pa agv1_w agv1_1-1 agv1_1-2 agv1_2-1 agv1_2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 53  44  43   1   5   2     1-5     1-2  5.3    4.15   1.15   2.3250   2.9750        0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 54  44  43   1   5   2     1-5     1-2  4.2    4.15   0.05   2.3250   1.8750        0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 55  44  45   2   5   2     2-5     2-2  4.1    3.15   0.95   2.2625   1.0875        0     0.75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 56  44  46   2   5   2     2-5     2-2  2.7    3.20  -0.50   2.2625   1.0875        0    -0.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 57  44  47   2   5   2     2-5     2-2  3.5    3.20   0.30   2.2625   1.0875        0     0.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 58  44  48   2   5   2     2-5     2-2  3.8    4.35  -0.55   2.2625   1.0875        0     0.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id  fid  mid loc gen sex loc.gen loc.sex agv2 agv2_pa agv2_w agv2_1-1 agv2_1-2 agv2_2-1 agv2_2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 01 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0     1-2    2       1      1        0        2        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 02 &lt;NA&gt; &lt;NA&gt;   1   0   1     1-0     1-1    2       1      1        2        0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 03 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0     1-2    2       1      1        0        2        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 04 &lt;NA&gt; &lt;NA&gt;   1   0   2     1-0     1-2    2       1      1        0        2        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 05 &lt;NA&gt; &lt;NA&gt;   2   0   2     2-0     2-2    0       1     -1        0        0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 06 &lt;NA&gt; &lt;NA&gt;   2   0   1     2-0     2-1    0       1     -1        0        0        0        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id fid mid loc gen sex loc.gen loc.sex agv2 agv2_pa agv2_w agv2_1-1 agv2_1-2 agv2_2-1 agv2_2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 53  44  43   1   5   2     1-5     1-2  5.3    4.15   1.15   2.3250   2.9750        0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 54  44  43   1   5   2     1-5     1-2  4.2    4.15   0.05   2.3250   1.8750        0     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 55  44  45   2   5   2     2-5     2-2  3.7    3.65   0.05   2.2625   1.0875        0     0.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 56  44  46   2   5   2     2-5     2-2  5.2    4.00   1.20   2.2625   1.0875        0     1.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 57  44  47   2   5   2     2-5     2-2  4.1    3.90   0.20   2.2625   1.0875        0     0.75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 58  44  48   2   5   2     2-5     2-2  4.3    3.60   0.70   2.2625   1.0875        0     0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot by generation (=trend)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="gen"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N    Sum     1-1     1-2 2-1     2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0 8 1.0000 0.25000 0.75000   0  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 8 1.4875 0.60000 0.61250   0  0.2750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2 8 1.8875 1.16875 0.88125   0 -0.1625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   3 8 2.7500 1.45000 1.17500   0  0.1250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   4 8 3.6125 1.92500 1.56250   0  0.1250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   5 8 4.0625 2.29375 1.68125   0  0.0875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gen N    Sum     1-1     1-2 2-1    2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0 8 1.0000 0.25000 0.75000   0 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 8 1.5500 0.60000 0.61250   0 0.3375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2 8 2.7125 1.16875 0.88125   0 0.6625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   3 8 3.2750 1.45000 1.17500   0 0.6500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   4 8 3.9250 1.92500 1.56250   0 0.4375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   5 8 4.4625 2.29375 1.68125   0 0.4875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-29.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-30.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret, lineTypeList=list("-1"=1, "-2"=2, def=3))</span>
<span class="r-plt img"><img src="print.AlphaPart-31.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-32.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    loc.gen N   Sum    1-1    1-2 2-1    2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1-0 4 2.000 0.5000 1.5000   0  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1-1 4 2.425 1.2000 1.2250   0  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1-2 4 2.700 1.4375 1.2625   0  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1-3 4 3.250 1.6750 1.5750   0  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1-4 4 4.275 2.1000 2.1750   0  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      1-5 4 4.600 2.3250 2.2750   0  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      2-0 4 0.000 0.0000 0.0000   0  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2-1 4 0.550 0.0000 0.0000   0  0.550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      2-2 4 1.075 0.9000 0.5000   0 -0.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     2-3 4 2.250 1.2250 0.7750   0  0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     2-4 4 2.950 1.7500 0.9500   0  0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     2-5 4 3.525 2.2625 1.0875   0  0.175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    loc.gen N   Sum    1-1    1-2 2-1   2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1-0 4 2.000 0.5000 1.5000   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1-1 4 2.425 1.2000 1.2250   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1-2 4 2.700 1.4375 1.2625   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1-3 4 3.250 1.6750 1.5750   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1-4 4 4.275 2.1000 2.1750   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      1-5 4 4.600 2.3250 2.2750   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      2-0 4 0.000 0.0000 0.0000   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2-1 4 0.675 0.0000 0.0000   0 0.675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      2-2 4 2.725 0.9000 0.5000   0 1.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     2-3 4 3.300 1.2250 0.7750   0 1.300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     2-4 4 3.575 1.7500 0.9500   0 0.875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     2-5 4 4.325 2.2625 1.0875   0 0.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret, lineTypeList=list("-1"=1, "-2"=2, def=3))</span>
<span class="r-plt img"><img src="print.AlphaPart-33.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-34.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends but only for location 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen", subset=res[[1]]$loc == 1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N   Sum    1-1    1-2 2-1 2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1-0 4 2.000 0.5000 1.5000   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1-1 4 2.425 1.2000 1.2250   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1-2 4 2.700 1.4375 1.2625   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1-3 4 3.250 1.6750 1.5750   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1-4 4 4.275 2.1000 2.1750   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1-5 4 4.600 2.3250 2.2750   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N   Sum    1-1    1-2 2-1 2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1-0 4 2.000 0.5000 1.5000   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1-1 4 2.425 1.2000 1.2250   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1-2 4 2.700 1.4375 1.2625   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1-3 4 3.250 1.6750 1.5750   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1-4 4 4.275 2.1000 2.1750   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1-5 4 4.600 2.3250 2.2750   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-35.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-36.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ## Summarize and plot location specific trends but only for location 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; (ret &lt;- summary(res, by="loc.gen", subset=res[[1]]$loc == 2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of partitions of breeding values </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - paths: 4 (1-1, 1-2, 2-1, 2-2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    - traits: 2 (agv1, agv2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N   Sum    1-1    1-2 2-1    2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     2-0 4 0.000 0.0000 0.0000   0  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2-1 4 0.550 0.0000 0.0000   0  0.550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2-2 4 1.075 0.9000 0.5000   0 -0.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2-3 4 2.250 1.2250 0.7750   0  0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2-4 4 2.950 1.7500 0.9500   0  0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2-5 4 3.525 2.2625 1.0875   0  0.175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Trait: agv2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loc.gen N   Sum    1-1    1-2 2-1   2-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     2-0 4 0.000 0.0000 0.0000   0 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2-1 4 0.675 0.0000 0.0000   0 0.675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     2-2 4 2.725 0.9000 0.5000   0 1.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2-3 4 3.300 1.2250 0.7750   0 1.300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2-4 4 3.575 1.7500 0.9500   0 0.875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2-5 4 4.325 2.2625 1.0875   0 0.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; plot(ret)</span>
<span class="r-plt img"><img src="print.AlphaPart-37.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="print.AlphaPart-38.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ###-----------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; ### demo_stohastic.R ends here</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.ed.ac.uk/roslin/highlanderlab" class="external-link">Gregor Gorjanc</a>, <a href="https://www.kis.si/en/Associates_OZ/Jana_Obsteter_1/" class="external-link">Jana Obsteter</a>, <a href="https://prof-thiagooliveira.netlify.app/" class="external-link">Thiago de Paula Oliveira</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

